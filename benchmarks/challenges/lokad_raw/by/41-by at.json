{
    "question": "Considering the table Input as given below, create a table Catalog from the table Input with every combination of Car and Color.\nCompute the average price for each car, for each color and for each combination of car and color (using the price as value indicator) then display the results.\n\ntable Input = with\n  [| as Car, as Color, as Price |]\n  [| \"Clio\", \"red\" , 25000|]\n  [| \"Clio\", \"green\" , 19000 |]\n  [| \"Megane\", \"yellow\" , 20000 |]\n  [| \"Megane\", \"yellow\" , 21000 |]\n  [| \"Megane\", \"black\" , 27000 |]\n  [| \"Hummer\", \"gold\" , 150000 |]",
    "answer": "```envision\ntable Input = with\n  [| as Car, as Color, as Price |]\n  [| \"Clio\", \"red\" , 25000|]\n  [| \"Clio\", \"green\" , 19000 |]\n  [| \"Megane\", \"yellow\" , 20000 |]\n  [| \"Megane\", \"yellow\" , 21000 |]\n  [| \"Megane\", \"black\" , 27000 |]\n  [| \"Hummer\", \"gold\" , 150000 |]\n\n// create the 'Catalog' table in 2 steps\n// step 1: define the 'Catalog' table using the 'by' keyword\ntable Catalog = by [Input.Car, Input.Color]\n// step 2: create the primary columns by aggregating from the 'Input' table into the 'Catalog' table\nCatalog.Car = same(Input.Car)\nCatalog.Color = same(Input.Color)\n\n// compute the average price per car by aggregating from the 'Input' table into the 'Catalog' table\n// specify the link using the by-at keywords\nCatalog.AvgPriceCar = avg(Input.Price) by Input.Car at Catalog.Car\n\n// compute the average price per color by aggregating from the 'Input' table into the 'Catalog' table\n// specify the link using the by-at keywords\nCatalog.AvgPriceColor = avg(Input.Price) by Input.Color at Catalog.Color\n\n// compute the average price per car and color by aggregating from the 'Input' table into the 'Catalog' table\nCatalog.AvgPrice = avg(Input.Price)\n\n// display the 'Catalog' table\n// use the stylecode {unit: \"€\"} to display the price currency\nshow table \"Catalog\" with\n  Catalog.Car\n  Catalog.Color\n  Catalog.AvgPriceCar {unit: \"€\"}\n  Catalog.AvgPriceColor {unit: \"€\"}\n  Catalog.AvgPrice {unit: \"€\"}\n```",
    "ref": "relational-algebra_index",
    "type": "coding"
}
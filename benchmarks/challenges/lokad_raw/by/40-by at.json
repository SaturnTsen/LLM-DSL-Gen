{
    "question": "Considering the tables Catalog and Orders as given below.\nFirst compute the number of sales for each car.\nThen compute the average sell price for each color (using the order amount as value indicator).\nFinally identify the best selling car by number of sales and best selling color by sell price. Display the results in the Catalog table.\n\ntable Catalog = with\n  [| as Car, as Color, as Price |]\n  [| \"Clio\", \"red\", 25000 |]\n  [| \"Clio\", \"green\", 19000 |]\n  [| \"Megane\", \"yellow\", 21000 |]\n  [| \"Megane\", \"black\", 27000 |]\n  [| \"Hummer\", \"red\", 150000 |]\n\ntable Orders = with\n  [| as Car, as Color, as OrderQty, as OrderAmount, as OrderDate |]\n  [| \"Clio\", \"green\", 2, 35000, date(2024, 7, 6) |]\n  [| \"Clio\", \"green\", 1, 20000, date(2024, 7, 19) |]\n  [| \"Clio\", \"green\", 1, 19000, date(2024, 8, 10) |]\n  [| \"Clio\", \"green\", 3, 57000, date(2024, 9, 9) |]\n  [| \"Clio\", \"red\", 1, 25000, date(2024, 7, 17) |]\n  [| \"Clio\", \"red\", 1, 26000, date(2024, 8, 5) |]\n  [| \"Megane\", \"yellow\", 1, 20500, date(2024, 8, 1) |]\n  [| \"Megane\", \"yellow\", 1, 23000, date(2024, 8, 18) |]\n  [| \"Hummer\", \"red\", 1, 155000, date(2024, 6, 29) |]",
    "answer": "```envision\ntable Catalog = with\n  [| as Car, as Color|]\n  [| \"Clio\", \"red\"|]\n  [| \"Clio\", \"green\"|]\n  [| \"Megane\", \"yellow\"|]\n  [| \"Megane\", \"black\"|]\n  [| \"Hummer\", \"red\"|]\n\ntable Orders = with\n  [|as Car, as Color, as OrderQty, as OrderAmount|]\n  [|\"Clio\", \"green\", 2, 35000|]\n  [|\"Clio\", \"green\", 1, 20000|]\n  [|\"Clio\", \"green\", 1, 19000|]\n  [|\"Clio\", \"green\", 3, 57000|]\n  [|\"Clio\", \"red\", 1, 25000|]\n  [|\"Clio\", \"red\", 1, 26000|]\n  [|\"Megane\", \"yellow\", 1, 20500|]\n  [|\"Hummer\", \"red\", 1, 155000|]\n\n// compute the number of sales per car by aggregating from the 'Orders' table into the 'Catalog' table\nCatalog.NbSalesCar = count(Orders.*) by Orders.Car at Catalog.Car\n\n// compute the average sell price per color by aggregating from the 'Orders' table into the 'Catalog' table\nCatalog.AvgSellPriceColor = avg(Orders.OrderAmount / Orders.OrderQty) by Orders.Color at Catalog.Color\n\n// identify the best selling car\n// step 1: compute the maximum number of sales per car overall\nmaxNbSalesCar = max(Catalog.NbSalesCar)\nCatalog.IsBestsellerCar = Catalog.NbSalesCar == maxNbSalesCar\n\n// identify the best selling color\nmaxSellPriceColor = max(Catalog.AvgSellPriceColor)\nCatalog.IsBestsellerColor = Catalog.AvgSellPriceColor == maxSellPriceColor\n\n// display the 'Catalog' table with the results\n// use the stylecode {booleans: \"✔️/❌\"} to aesthetically display the booleans\n// use the stylecode {unit: \"€\"} to display the price currency\nshow table \"Catalog\" {booleans: \"✔️/❌\"} with\n  Catalog.Car\n  Catalog.Color\n  Catalog.NbSalesCar\n  Catalog.IsBestsellerCar\n  Catalog.AvgSellPriceColor {unit: \"€\"}\n  Catalog.IsBestsellerColor\n```",
    "ref": "",
    "type": "coding"
}
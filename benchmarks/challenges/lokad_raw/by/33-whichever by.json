{
    "question": "Considering the table Input as given below, create a table Catalog from the table Input with every combination of Car and Color.\nCompute the minimum price for each car, for each color and for each combination of car and color. Display the table Catalog.\n\ntable Input = with\n  [| as Car, as Color, as Price |]\n  [| \"Clio\", \"red\" , 25000|]\n  [| \"Clio\", \"green\" , 19000 |]\n  [| \"Megane\", \"yellow\" , 20000 |]\n  [| \"Megane\", \"yellow\" , 21000 |]\n  [| \"Megane\", \"black\" , 27000 |]\n  [| \"Hummer\", \"gold\" , 150000 |]",
    "answer": "```envision\ntable Input = with\n  [| as Car, as Color, as Price |]\n  [| \"Clio\", \"red\" , 25000|]\n  [| \"Clio\", \"green\" , 19000 |]\n  [| \"Megane\", \"yellow\" , 20000 |]\n  [| \"Megane\", \"yellow\" , 21000 |]\n  [| \"Megane\", \"black\" , 27000 |]\n  [| \"Hummer\", \"gold\" , 150000 |]\n\n// create the 'Catalog' table in 2 steps\n// step 1: define the 'Catalog' table using the 'whichever by' keyword\ntable Catalog = whichever by [Input.Car, Input.Color]\n// step 2: create the primary column by aggregating from the 'Input' table into the 'Catalog' table\nCatalog.Car = same(Input.Car)\nCatalog.Color = same(Input.Color)\n\n// compute the minimum price per car by aggregating from the 'Input' table into the 'Catalog' table\n// specify the link using the by-at keywords\nCatalog.MinPriceCar = min(Input.Price) by Input.Car at Catalog.Car\n\n// compute the minimum price per color by aggregating from the 'Input' table into the 'Catalog' table\n// specify the link using the by-at keywords\nCatalog.MinPriceColor = min(Input.Price) by Input.Color at Catalog.Color\n\n// compute the minimum price per car and color by aggregating from the 'Input' table into the 'Catalog' table\nCatalog.MinPrice = min(Input.Price)\n```",
    "ref": "relational-algebra_index",
    "type": "coding"
}
{
    "question": "Considering the table Input as given below, create a table Car from the table Input with the values of the column Car.\nFor each car compute the number of lines, the number of different colors and the average price (using the price as value indicator) then display the results.\ntable Input = with\n  [| as Car, as Color, as Price |]\n  [| \"Clio\", \"red\" , 25000|]\n  [| \"Clio\", \"green\" , 19000 |]\n  [| \"Megane\", \"yellow\" , 20000 |]\n  [| \"Megane\", \"yellow\" , 21000 |]\n  [| \"Megane\", \"black\" , 27000 |]\n  [| \"Hummer\", \"gold\" , 150000 |]",
    "answer": "```envision\ntable Input = with\n  [| as Car, as Color, as Price |]\n  [| \"Clio\", \"red\" , 25000|]\n  [| \"Clio\", \"green\" , 19000 |]\n  [| \"Megane\", \"yellow\" , 20000 |]\n  [| \"Megane\", \"yellow\" , 21000 |]\n  [| \"Megane\", \"black\" , 27000 |]\n  [| \"Hummer\", \"gold\" , 150000 |]\n\n// create the 'Car' table in 2 steps\n// step 1: define the 'Car' table using the 'whichever by' keyword\ntable Car = by [Input.Car]\n// step 2: create the primary columns by aggregating from the 'Input' table into the 'Car' table\nCar.Car = same(Input.Car)\n\n// compute the number of lines price per car by aggregating from the 'Input' table into the 'Car' table\nCar.NbLines = count(Input.*)\n\n// compute the number of different colors per car by aggregating from the 'Input' table into the 'Car' table\nCar.NbColor = distinct(Input.Color)\n\n// compute the average price per car by aggregating from the 'Input' table into the 'Car' table\nCar.AvgPrice = avg(Input.Price)\n\n// display the 'Car' table\n// use the stylecode {unit: \"€\"} to display the price currency\nshow table \"Car\" with\n  Car.Car\n  Car.NbLines\n  Car.NbColor\n  Car.AvgPrice {unit: \"€\"}\n```",
    "ref": "relational-algebra_index",
    "type": "coding"
}